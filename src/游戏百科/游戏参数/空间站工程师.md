# 空间站工程师专用服务器指南

## 目录

1 系统要求  
2 获取服务器文件  
3 默认端口  
4 服务器启动参数  
4.1 日志记录  
5 快速入门  
6 示例  
6.1 通过 setting.xml 配置  
7 游戏存档  
7.1 通过 worldsettings.xml 配置  
7.2 通过 world.xml 配置  
8 服务器管理员  
8.1 游戏内管理员  
8.2 服务器程序控制台  
8.3 命令列表  
9 服务器模组支持  
9.1 modconfig.xml  
9.2 备用 ModConfig.xml  
9.3 模组存储  



## 系统要求
■ Linux 或 Windows 系统（物理机或虚拟机）  
■ **不推荐** 同时运行 Stationeers 客户端（可能导致路由器 NAT 回环问题）  
■ Linux 需 Glibcxx 3.4.29 & Glibc 2.34 (Ubuntu 22.04 LTS)  
■ Windows 需安装 [Microsoft Visual C++ 2015/2017/2019 运行库](https://aka.ms/vs/16/release/vc_redist.x64.exe)  
■ ~16GB 内存（Linux 实测验证），≤8GB 将无法启动  



## 获取服务器文件
**SteamCmd (Windows/Linux)**  
[SteamCMD 使用指南](https://developer.valvesoftware.com/wiki/SteamCMD)  
```bash
# 稳定版
steamcmd +login anonymous +app_update 600760 validate +quit

# 测试版
steamcmd +login anonymous +app_update 600760 -beta beta validate +quit

# 从测试版退回公开版
steamcmd +login anonymous +app_update 600760 -beta public validate +quit
```
## 默认端口
|端口|协议|用途|
|---|---|---|
|8081|TCP|元服务器通信|
|27016|UDP|游戏数据传输|
|27015|UDP|Steam更新|

## 服务器启动参数
|参数|值类型|描述|
|---|---|---|
|-NEW|字符串|用指定世界类型创建新游戏（必须提供有效世界类型）|
|-NEWGAME|字符串|同 -NEW|
|-LOAD|字符串|加载存档文件夹（可附加世界类型参数作为加载失败时的备用方案）|
|-LOADGAME|字符串|同 -LOAD|
|-LOADLATEST|字符串|加载指定存档文件夹的最新备份（基于 world.xml 时间戳）|
|-file start|复合参数|加载指定空间站最新存档（未找到则用参数创建新世界）|
|-JOIN / -JOINGAME|字符串|加入指定地址的服务器（格式：[地址]:[端口]）|
|-SETTINGSPATH|路径|指定自定义配置文件的绝对基目录|
|-logfile|路径|指定自定义日志路径（默认使用 output_log.txt）|


# Stationeers 游戏配置文件翻译与注释

```bash
<?xml version="1.0" encoding="utf-8"?>
<SettingData xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  
  <!-- 自动保存设置 -->
  <AutoSave>true</AutoSave>          <!-- 是否启用自动保存（true/false） -->
  <SaveInterval>300</SaveInterval>   <!-- 自动保存间隔时间（秒） -->
  <SavePath />                        <!-- 自定义保存路径（空表示默认路径） -->

  <!-- 游戏难度设置 -->
  <StartingConditions>Default</StartingConditions>  <!-- 初始条件（Default/Empty 等） -->
  <RespawnCondition>Easy</RespawnCondition>         <!-- 重生难度（Easy/Medium/Hard） -->
  <HungerRate>0.5</HungerRate>                      <!-- 饥饿速率（0.5=50%标准速度） -->
  <SunOrbitPeriod>1</SunOrbitPeriod>                <!-- 太阳公转周期（1=标准速度） -->

  <!-- 研究系统 -->
  <ResearchPoolKey>ResearchOff</ResearchPoolKey>    <!-- 研究模式（ResearchOff=禁用） -->

  <!-- 游戏性能 -->
  <RoomControlTickSpeed>1</RoomControlTickSpeed>    <!-- 房间控制计算速度（1=标准） -->
  <WorldOrigin>false</WorldOrigin>                  <!-- 世界原点显示（true/false） -->

  <!-- 多人服务器设置 -->
  <ServerName>Stationeers</ServerName>        <!-- 服务器显示名称 -->
  <StartLocalHost>true</StartLocalHost>       <!-- 启动本地主机（true/false） -->
  <ServerVisible>true</ServerVisible>         <!-- 服务器可见性（true/false） -->
  <ServerPassword />                          <!-- 加入密码（空表示无密码） -->
  <AdminPassword>randomstringhere</AdminPassword>  <!-- 管理员密码 -->
  <ServerMaxPlayers>10</ServerMaxPlayers>     <!-- 最大玩家数量 -->
  <UpdatePort>27015</UpdatePort>              <!-- 服务器更新端口 -->
  <GamePort>27016</GamePort>                  <!-- 游戏通信端口 -->
  <UPNPEnabled>true</UPNPEnabled>             <!-- 启用UPNP自动端口映射 -->
  <DisconnectTimeout>10000</DisconnectTimeout> <!-- 断线超时时间（毫秒） -->
  <NetworkDebugFrequency>500</NetworkDebugFrequency> <!-- 网络调试频率 -->
```

| XML 属性                  | 参数值/范围              | 详细说明                                                                 |
| :------------------------ | :----------------------- | :-----------------------------------------------------------------------|
| `RespawnCondition`      | Easy, Normal, Stationeer 或 Mod 自定义键 | 似乎用于新玩家的生成条件（而非重生）。|
| `StartingConditions`    | Default, Minimal, Vulcan, Venus, BareBones 或 Mod 自定义键 | 服务器忽略此设置。用于定义自定义世界类型。|
| `ResearchPoolKey`       | ResearchOff, ResearchOn 或 Mod 自定义键 | 服务器忽略此设置。|
| `SunOrbitPeriod`        | 数字 (默认值=1)          | **未文档化**。太阳轨道周期的乘数。默认周期为 20 分钟（10 分钟白昼，10 分钟黑夜）。|
| `UseCustomWorkThreadsCount` | true, false             | 是否使用自定义工作线程数。|
| `MinWorkerThreads`      | 数字 (默认值=8)          | 最小工作线程数。|
| `MinCompletionPortThreads` | 数字 (默认值=8)          | 最小 I/O 完成端口线程数。|
| `MaxWorkerThreads`      | 数字 (默认值=100)        | 最大工作线程数。 |
| `MaxCompletionPortThreads` | 数字 (默认值=50)         | 最大 I/O 完成端口线程数。|
| `CoroutineTimeBudget`   | 数字 (默认值=1)          | 协程时间预算（单位：毫秒？）。**未文档化**。|

## 服务器模组支持
### 模组配置 (modconfig.xml)
```bash
<?xml version="1.0"?>
<ModConfig>
  <Mods>
    <ModData>
      <Id>0</Id>
      <IsEnabled>true</IsEnabled>
      <LocalPath>您的模组文件夹名</LocalPath>
    </ModData>
    <!-- 多个模组按此格式添加 -->
  </Mods>
</ModConfig>
```
### 模组存放路径
|系统|路径|
|---|---|
|Windows|C:\Users\用户名\Documents\My Games\Stationeers\mods\|
|Linux|/home/用户名/My Games/Stationeers/mods/|
|专用服务器|[安装目录]/rocketstation_DedicatedServer_Data/StreamingAssets/Data/Mods/|


注意：需手动创建 Mods 文件夹，模组结构应为：
模组名/About/ (描述文件)
模组名/GameData/ (游戏数据文件)


## 服务器管理员 / 游戏内管理员 

<ServerAuthSecret/> 参数必须同时添加到服务器端和客户端的 setting.xml 文件中，并且使用相同的令牌 (token)​。

## ​命令输入方式​

​默认方式 (玩家聊天窗口)：​​ 所有命令默认在游戏内的聊天窗口（按 F3 键打开）中输入，并且必须以 serverrun 作为前缀 (prefixed by)​。

例如：要输入 HELP 命令，需在聊天框中输入 serverrun HELP。

​服务器程序控制台：​​ 您也可以在运行中的服务器应用程序（其本身就像一个控制台）中直接输入命令。

## ​命令列表 (Command Lists)​
| 命令 (Command)             | 说明 (Details)                                                                 | 参数 (Parameter)                                                                 |
| :------------------------- | :----------------------------------------------------------------------------- | :------------------------------------------------------------------------------- |
| **HELP**                   | 显示帮助信息                                                                   | `commands`<br>`list (l)`<br>`<key>`<br>`tofile`: 将帮助输出打印到文件             |
| **CLEAR**                  | 清除所有控制台文本                                                             |                                                                                  |
| **QUIT**                   | 立即退出游戏，无提示                                                           |                                                                                  |
| **EXIT**                   | 离开游戏会话，返回'开始菜单'                                                   |                                                                                  |
| **LEAVE**                  | (同 EXIT)                                                                      |                                                                                  |
| **NEW** / **NEWGAME**      | 启动时自动在指定世界开始新游戏                                                 | `worldName` (世界名称)                                                           |
| **LOAD** / **LOADGAME**    | 加载已保存的世界文件                                                           | `<foldername>` (文件夹名)                                                        |
| **LOADLATEST**             | 加载最新的保存文件（包括自动保存）                                             | `<foldername>` (文件夹名)                                                        |
| **JOIN** / **JOINGAME**    | 将客户端连接到服务器                                                           | `[address]:[port]` (地址:端口)                                                  |
| **STEAM**                  | 测试 Facepunch API（检查 Steam 是否初始化及 DLC 是否购买）                     |                                                                                  |
| **LISTNETWORKDEVICES**     | 无帮助文本 :                                                                 | `id`                                                                             |
| **TESTBYTEARRAY**          | 测试世界中每个物品的网络读写功能是否并行（仅在编辑器中启用）                   | 提供参考 ID 以仅检查该物品                                                       |
| **ROCKETBINARY**           | 开始记录增量更新中每个部分的大小                                               | `toggleloglength`<br>`togglelogbps`                                               |
| **IMGUI**                  | 切换 ImguiInWorldTestCube 的开启/关闭状态                                      |                                                                                  |
| **ATMOS**                  | 启用大气调试                                                                   | `pipe`<br>`world`<br>`room`<br>`global`<br>`thing`                               |
| **THING**                  | 物品相关命令                                                                   | 无参数：返回物品总数<br>`find`<br>`delete`<br>`spawn`                            |
| **KEYBINDINGS**            | 显示绑定到 LocalHuman 的所有键位绑定                                           | `reset`: 重置键位绑定栈（可帮助解决输入问题）                                    |
| **RESET**                  | 重启应用程序                                                                   |                                                                                  |
| **VERSION**                | 返回游戏版本                                                                   |                                                                                  |
| **LOGTOCLIPBOARD**         | 将控制台缓冲区的内容复制到系统剪贴板                                           |                                                                                  |
| **KICK**                   | 将客户端踢出服务器                                                             | `clientId` - 断开客户端与游戏的连接                                              |
| **BAN**                    | 禁止客户端连接服务器（仅服务器命令）                                           | `clientId`                                                                       |
| **UPNP**                   | 返回通用即插即用 (UPnP) 状态                                                   |                                                                                  |
| **NETWORK**                | 返回当前网络状态                                                               |                                                                                  |
| **PAUSE**                  | 暂停/取消暂停游戏（包括客户端）                                                | `true`<br>`false`                                                                |
| **SAY**                    | 向所有连接的玩家发送消息                                                       |                                                                                  |
| **SAVE**                   | 将当前游戏保存到指定路径                                                       | `<foldername>`<br>`delete <foldername>`<br>`list`                                |
| **LOG**                    | 将所有日志转储到文件                                                           | `<logname>` (可选) `clear`                                                       |
| **DISCORD**                | 与 Discord SDK 交互                                                            |                                                                                  |
| **SETTINGS**               | 更改 settings.xml（例如 `settings servermaxplayers 5`）                        | `list`<br>`print`<br>`<PropertyName> <Value>`                                    |
| **NETCONFIG**              | 更改 NetConfig.xml 中的主服务器设置（例如 `netconfig ip 127.0.0.1`）           | `list`<br>`print`<br>`<PropertyName> <Value>`                                    |
| **SETTINGSPATH**           | 将默认设置路径设置为新位置（仅启动命令）。未找到则使用默认路径。               | `<full-directory-path>` (完整目录路径)                                           |
| **DIFFICULTY**             | 将游戏难度设置为预定义的设置之一                                               | `-DIFFICULTY [<difficulty>]`                                                     |
| **REGENERATEROOMS**        | 为世界重新生成所有房间                                                         |                                                                                  |
| **STORM START**            | 开始天气事件                                                                   |                                                                                  |
| **STORM STOP**             | 停止天气事件                                                                   |                                                                                  |
| **DEBUGTHREADS**           | 显示工作线程运行所需的时间                                                     | `GameTick`                                                                       |
| **STATUS**                 | 显示大量信息以了解服务器状态                                                   |                                                                                  |
| **MASTERSERVER**           | 帮助与主服务器交互的命令                                                       | `refresh`                                                                        |
| **DELETELOOSEITEMS**       | 移除世界中所有不在槽位中的物品                                                 |                                                                                  |
| **SUNTIME**                | 设置一天中的时间（0 到 1 之间，例如 0 是日出，0.5 是日落）                     | `time`                                                                           |
| **CLEANUPPLAYERS**         | 清理玩家尸体                                                                   | `dead`<br>`disconnected`<br>`all`                                                |
| **TEST**                   | 无帮助文本 